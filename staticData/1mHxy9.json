{"post":{"id":35,"path":"/2016/01/08/vimagit/","date":"2016/01/08 00:00","title":"vimでgitするにはvimagitがおすすめ","tags":["vim"],"body":"<p>年末に知った<a href=\"https://github.com/jreybert/vimagit\">vimagit</a>ってvimのプラグインが使ってて気持ち良い。<br>\nGitの差分をvimで開けて、行単位でStageしたりCommitできる。<br>\n<code>git add -p</code>するvimmerには特におすすめ！</p>\n<p>ちなみにEmacsプラグインの<a href=\"https://github.com/magit/magit\">magit</a>ってやつのコピー版らしい。<br>\nインストール〜使い方、オススメ設定まで記載しておく。</p>\n<h1>インストール</h1>\n<pre><code class=\"hljs vim\">NeoBundle <span class=\"hljs-string\">'jreybert/vimagit'</span>\n</code></pre>\n<h1>使い方</h1>\n<p><a href=\"https://github.com/jreybert/vimagit\">GitHubのリポジトリ</a>にリンクされてる<a href=\"https://asciinema.org/a/28761\">ビデオ</a>とかを見るとざっくりイメージできると思う。</p>\n<h3>開き方</h3>\n<p><code>:Magit</code> または <code>&lt;Leader&gt;M</code>でbufferを開く。</p>\n<h3>セクション</h3>\n<p>bufferは以下の5つのセクションに分かれている。<br>\n後で記載するけど表示順などをオプションで指定できる。</p>\n<ul>\n<li><strong>info</strong>: current branchやHEAD commitのメッセージなどが表示されている</li>\n<li><strong>Commit message</strong>: コミットする時に現れて、メッセージを入力する</li>\n<li><strong>Staged changes</strong>: そのままだけどStagingされた変更部分</li>\n<li><strong>Unstaged changes</strong>: まだStagingされてない変更部分。Untracked filesもここに表示される</li>\n<li><strong>Stash list</strong>: Stashのリスト</li>\n</ul>\n<h3>コマンド</h3>\n<p><a href=\"https://github.com/jreybert/vimagit/blob/master/README.md\">README</a>みれば丁寧に書いてあるけど、自分が普段使うものを記載しておく。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">command</th>\n<th style=\"text-align:left\">description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">:Magit または &lt;Leader&gt;M</td>\n<td style=\"text-align:left\">magit bufferを開く。すべてはここから</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">S</td>\n<td style=\"text-align:left\">Stage &lt;-&gt; Unstage の切り替え。ファイル名の上ならファイルごとStageされるし、vで行選択すればその行だけStageされる</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">DDD</td>\n<td style=\"text-align:left\">Unstagedセクションでだけ使える。変更を破棄する</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CC</td>\n<td style=\"text-align:left\">Commitセクション以外にいるならCommitセクションを開く。CommitセクションにいるならCommitする(説明むずい)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CA</td>\n<td style=\"text-align:left\">CCのcommit --amendバージョン。直前のcommitに含めるならこれ。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CF</td>\n<td style=\"text-align:left\">commit --amendで、コミットメッセージを変更しない場合はこのコマンド一発で完了</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">R</td>\n<td style=\"text-align:left\">bufferをrefreshする</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">q</td>\n<td style=\"text-align:left\">bufferを閉じる</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">h</td>\n<td style=\"text-align:left\">help表示のON/OFF</td>\n</tr>\n</tbody>\n</table>\n<p>他にもIやLとか色々あるけど、自分はほぼ使ってない。</p>\n<h3>オプション</h3>\n<p>vimrcで指定できるオプション。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">option</th>\n<th style=\"text-align:left\">description</th>\n<th style=\"text-align:left\">default</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">g:magit_enabled</td>\n<td style=\"text-align:left\">vimagitの有効[1]・無効[0]</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">g:magit_show_help</td>\n<td style=\"text-align:left\">ヘルプの表示[1]・非表示[0]</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">g:magit_default_show_all_files</td>\n<td style=\"text-align:left\">bufferを開いた時にdiffを閉じておく[0]・modified filesのdiffだけ表示[1]・全ファイルのdiffを表示[2]</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">g:magit_default_fold_level</td>\n<td style=\"text-align:left\">上記のdiff表示の詳細設定。ファイル名だけ表示する[0]・ファイル名とhunkの一覧だけ表示[1]・hunkの中身のdiffも表示[2]</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">g:magit_default_sections</td>\n<td style=\"text-align:left\">各セクションの表示/非表示と順番</td>\n<td style=\"text-align:left\">['info', 'global_help', 'commit', 'staged', 'unstaged']</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">g:magit_warning_max_lines</td>\n<td style=\"text-align:left\">bufferを開く際にwarningを出すdiffの行数。実際に開くかはyes/noで回答</td>\n<td style=\"text-align:left\">10000</td>\n</tr>\n</tbody>\n</table>\n<h1>オススメ設定</h1>\n<p>自分がやってる設定と理由を簡単に。</p>\n<pre><code class=\"hljs vim\"><span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">g:magit_show_help</span> = <span class=\"hljs-number\">0</span>  <span class=\"hljs-comment\">\" 少し慣れたらいらなくなる</span>\n<span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">g:magit_default_show_all_files</span> = <span class=\"hljs-number\">2</span>  <span class=\"hljs-comment\">\" わざわざ開くのは面倒なので</span>\n<span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">g:magit_default_fold_level</span> = <span class=\"hljs-number\">2</span>  <span class=\"hljs-comment\">\" 同上</span>\n<span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">g:magit_default_sections</span> = [<span class=\"hljs-string\">'global_help'</span>, <span class=\"hljs-string\">'info'</span>, <span class=\"hljs-string\">'unstaged'</span>, <span class=\"hljs-string\">'staged'</span>, <span class=\"hljs-string\">'commit'</span>]  <span class=\"hljs-comment\">\" helpはデフォルト非表示。次にcurrent情報。それ以下は上から順に処理していくイメージ</span>\n</code></pre>\n<p>最初のcommitが2015年9月。 READMEにもあるようにまだまだ機能追加されそう。</p>\n<p>VimでGitといえば<a href=\"https://github.com/tpope/vim-fugitive\">fugitive</a>だと思うけど、それには無いものをいっぱい持ってるし、併用もアリだと思う！</p>\n"}}